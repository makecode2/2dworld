<html><head><link href="style.css" rel="stylesheet"></head><body><div><h3>2d world generator</h3></div><?phpfunction dd($value){    echo "<pre>";    var_dump($value);    echo "</pre>";	die();}$mass=array();$mass1=array();for($m=0;$m<40;$m++){$mass[$m]=rand(0,4)+4;if($m>1){	$diff=$mass[$m-1]-$mass[$m];	if($diff>=2 or $diff<=-2 ){	$mass[$m]=rand(0,3)+4;	}}}/*echo "<div>";echo "ground level: ";for($n=0;$n<40;$n++){echo $mass[$n];}echo "</div>";*/echo "<div class='table1'>";echo "<table border='1'>";for($i=0;$i<20;$i++){	echo "<tr>";	for($j=0;$j<40;$j++){		echo "<td>";		if($mass[$j]==$i) {			echo "W";			$mass1[$i][$j]="W";			}		else if($mass[$j]>$i){			echo ".";			$mass1[$i][$j]=".";			}		else if($mass[$j]<$i){			echo "g";			$mass1[$i][$j]="g";			}		else {echo ".";}		echo "</td>";	}	echo "</tr>";}echo "</table>";echo "</div>";////////////////////////====================//dd($mass1);//dd($mass1);for($i=0;$i<20;$i++){	for($j=0;$j<39;$j++){        if($mass1[$i][$j]=="W"){			if($j<38){			    if($mass1[$i-1][$j+1]=="g"){				    $mass1[$i-1][$j+1]="O";				    $x=$j+1;				    $y=$i-1;				    $dir=rand(0,3);				    if($mass1[$y+1][$x]=="g" and $dir==0) {				        $mass1[$y+1][$x]="o";				        }				    if($mass1[$y-1][$x]=="g" and $dir==1) {				        $mass1[$y-1][$x]="o";				        }				    if($mass1[$y][$x+1]=="g" and $dir==2) {				        $mass1[$y][$x+1]="o";				        }				    if($mass1[$y][$x-1]=="g" and $dir==3) {				        $mass1[$y][$x-1]="o";				        }							    }/////////            }		}	}	}	for($i=0;$i<19;$i++){	for($j=0;$j<39;$j++){	if($mass1[$i][$j]=="o"){		$dip=rand(0,10);		for($g=0;$g<$dip;$g++){		$dir1=rand(0,3);		$y1=$i;		$x1=$j;		if($dir1==0){			$y1++;			if($mass1[$y1][$x1]=="g"){$mass1[$y1][$x1]="o";}		}		if($dir1==1){			$y1--;			if($mass1[$y1][$x1]=="g"){$mass1[$y1][$x1]="o";}		}		if($dir1==2){			$x1++;			if($mass1[$y1][$x1]=="g"){$mass1[$y1][$x1]="o";}		}		if($dir1==3){			$x1--;			if($mass1[$y1][$x1]=="g"){$mass1[$y1][$x1]="o";}		}		}	}	}}// tree generatorfor($i=0;$i<20;$i++){	for($j=0;$j<40;$j++){		if($mass1[$i][$j]=="W"){		$is_tree=rand(0,2);			if($is_tree==1){				$tree_type=rand(0,3);				if($tree_type==0){					$mass1[$i-1][$j]="t";//just a small tree				}				if($tree_type==1){					$mass1[$i-1][$j]="t0";//2 cells heigh tree					$mass1[$i-2][$j]="t2";				}				if($tree_type==2){					$mass1[$i-1][$j]="t0";//3 cells tree					$mass1[$i-2][$j]="t1";					$mass1[$i-3][$j]="t2";				}			}		}	}}//emerald genetator$ex=rand(2,39);$ey=rand(2,19);if($mass1[$ey][$ex]=="g"){	$isem=rand(0,200);	if($isem==2){	$mass1[$ey][$ex]="e";	}} echo "</div>";	echo "<script>";echo "var map=[];";for($i=0;$i<3;$i++){//several lines of 0 in the top of the map array	echo "map.push([";	for($j=0;$j<40;$j++){		if($j==0){			echo "'" . 0 . "'";			}else{			echo ",'" . 0 . "'";			}				}	echo "]);".PHP_EOL;}for($i=0;$i<20;$i++){//map array	echo "map.push([";	for($j=0;$j<40;$j++){		if($j==0){			echo "'" . $mass1[$i][$j] . "'";			}else{			echo ",'" . $mass1[$i][$j] . "'";			}				}	echo "]);".PHP_EOL;}for($i=0;$i<3;$i++){//several lines of 0 in the buttom	echo "map.push([";	for($j=0;$j<40;$j++){		if($j==0){			echo "'" . 0 . "'";			}else{			echo ",'" . 0 . "'";			}				}	echo "]);".PHP_EOL;}echo "</script>";?><br><div id="help">use arrows to navigate, spacebar to dig and a and d to move digging frame<br></div><div id="var"></div><canvas id="c"></canvas><br><div id="bag">bag. Use w to select things<table border="1"><tr><td id="grass_bag_pic"><img src="image/grass.png" onclick="item_select(0)"></td><td id="rock_bag_pic"><img src="image/rock.png" onclick="item_select(1)"></td><td id="soil_bag_pic"><img src="image/soil.png" onclick="item_select(2)"></td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td></tr><tr><td id="grass_num">0</td><td id="rock_num">0</td><td id="soil_num">0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr></table></div><img class="inv" id="grass_pic" src="image/grass.png"><img class="inv" id="grass_frame_pic" src="image/grass_frame.png"><img class="inv" id="tree_pic" src="image/tree.png"><img class="inv" id="tree0_pic" src="image/tree0.png"><img class="inv" id="tree1_pic" src="image/tree1.png"><img class="inv" id="tree2_pic" src="image/tree2.png"><img class="inv" id="rock_pic" src="image/rock.png"><img class="inv" id="rock_frame_pic" src="image/rock_frame.png"><img class="inv" id="sky_pic" src="image/sky.png"><img class="inv" id="sky_frame_pic" src="image/sky_frame.png"><img class="inv" id="soil_pic" src="image/soil.png"><img class="inv" id="soil_frame_pic" src="image/soil_frame.png"><img class="inv" id="pig_pic_r" src="image/pig_r.png"><img class="inv" id="pig_pic_l" src="image/pig_l.png"><img class="inv" id="cow_pic_r" src="image/cow_r.png"><img class="inv" id="cow_pic_l" src="image/cow_l.png"><img class="inv" id="player_pic_r" src="image/player_r.png"><img class="inv" id="player_pic_l" src="image/player_l.png"><img class="inv" id="player_pic_cl_r" src="image/player_cl_r.png"><img class="inv" id="player_pic_cl_l" src="image/player_cl_l.png"><img class="inv" id="player_rock_l" src="image/player_rock_l.png"><img class="inv" id="player_rock_r" src="image/player_rock_r.png"><img class="inv" id="emerald_pic" src="image/emerald.png"><script>var width = 25*40,    height = 25*20,	gLoop,	c = document.getElementById('c'),	ctx = c.getContext('2d');	var	pig_x = 2,	pig_y = 2,	pig_buf="",	pig_dir="r";var cow_x = 15,	cow_y = 2,	cow_buf="",	cow_dir = "r";	var player_x = 10,	player_y = 2,	player_buf = ".",//this is to store what was in array before player moved there	player_target_x=0,	player_target_y=0,	player_target_offset_x=0,//can be from 0 to 8, this is 8 positions of the target frame	player_target_offset_y=0,	player_target_buf="W",	player_state = "r";	var grass_n = 0,    soil_n = 0,    rock_n=0;	it_selected=0;			c.width = width;	c.height = height;	var tree_pic = document.getElementById("tree_pic"),    tree0_pic = document.getElementById("tree0_pic"),	tree1_pic = document.getElementById("tree1_pic"),	tree2_pic = document.getElementById("tree2_pic"),	rock_pic = document.getElementById("rock_pic"),	rock_frame_pic = document.getElementById("rock_frame_pic"),	grass_pic = document.getElementById("grass_pic"),	grass_frame_pic = document.getElementById("grass_frame_pic"),	sky_pic = document.getElementById("sky_pic"),	sky_frame_pic = document.getElementById("sky_frame_pic"),	soil_pic = document.getElementById("soil_pic"),	soil_frame_pic = document.getElementById("soil_frame_pic"),	cow_pic = document.getElementById("cow_pic"),    pig_pic_r = document.getElementById("pig_pic_r"),		pig_pic_l = document.getElementById("pig_pic_l"),	cow_pic_r = document.getElementById("cow_pic_r"),	cow_pic_l = document.getElementById("cow_pic_l"),	player_pic_r = document.getElementById("player_pic_r"),	player_pic_l = document.getElementById("player_pic_l"),	player_pic_cl_l = document.getElementById("player_pic_cl_l"),	player_pic_cl_r = document.getElementById("player_pic_cl_r"),	player_rock_r = document.getElementById("player_rock_r"),	player_rock_l = document.getElementById("player_rock_l"),	emerald_pic = document.getElementById("emerald_pic");function item_select(a){	it_selected=a;}	function show_map(){document.getElementById("grass_num").innerHTML = grass_n;//show things in the bagdocument.getElementById("soil_num").innerHTML = soil_n;document.getElementById("rock_num").innerHTML = rock_n;if(it_selected==0){///////////////////////////////////////////////////bag	document.getElementById("grass_bag_pic").innerHTML = "<img src='image/grass_frame.bmp' onclick='item_select(0)'>";	document.getElementById("rock_bag_pic").innerHTML = "<img src='image/rock.bmp' onclick='item_select(1)'>";	document.getElementById("soil_bag_pic").innerHTML = "<img src='image/soil.bmp' >";	}if(it_selected==1){	document.getElementById("rock_bag_pic").innerHTML = "<img src='image/rock_frame.bmp' onclick='item_select(1)'>";	document.getElementById("grass_bag_pic").innerHTML = "<img src='image/grass.bmp' onclick='item_select(0)'>";	document.getElementById("soil_bag_pic").innerHTML = "<img src='image/soil.bmp' >";	}if(it_selected==2){	document.getElementById("rock_bag_pic").innerHTML = "<img src='image/rock.bmp' onclick='item_select(1)'>";	document.getElementById("grass_bag_pic").innerHTML = "<img src='image/grass.bmp' onclick='item_select(0)'>";	document.getElementById("soil_bag_pic").innerHTML = "<img src='image/soil_frame.bmp' >";	}	//player_target_buf=map[player_y+1][player_x+1];	for(var i=0;i<20;i++){		for(var j=0;j<40;j++){			//document.write(map[i][j]);			if(map[i][j]=="."){				ctx.drawImage(sky_pic, j*25, i*25);			}			if(map[i][j]=="W"){				ctx.drawImage(grass_pic, j*25, i*25);			}			if(map[i][j]=="g"){				ctx.drawImage(soil_pic, j*25, i*25);			}			if(map[i][j]=="O"){				ctx.drawImage(rock_pic, j*25, i*25);			}			if(map[i][j]=="o"){				ctx.drawImage(rock_pic, j*25, i*25);			}			if(map[i][j]=="t"){				ctx.drawImage(tree_pic, j*25, i*25);			}			if(map[i][j]=="t0"){				ctx.drawImage(tree0_pic, j*25, i*25);			}			if(map[i][j]=="t1"){				ctx.drawImage(tree1_pic, j*25, i*25);			}			if(map[i][j]=="t2"){				ctx.drawImage(tree2_pic, j*25, i*25);			}			if(map[i][j]=="e"){				ctx.drawImage(emerald_pic, j*25, i*25);			}			if(map[i][j]=="p"){				if(pig_dir=="r"){				ctx.drawImage(pig_pic_r, j*25, i*25);				}				if(pig_dir=="l"){				ctx.drawImage(pig_pic_l, j*25, i*25);				}			}			if(map[i][j]=="c"){				if(cow_dir=="r"){				ctx.drawImage(cow_pic_r, j*25, i*25);				}				if(cow_dir=="l"){				ctx.drawImage(cow_pic_l, j*25, i*25);				}			}			if(map[i][j]=="pl"){				if(player_state=="r"){								ctx.drawImage(player_pic_r, j*25, i*25);					if(player_buf=="o" || player_buf=="O"){					ctx.drawImage(player_rock_r, j*25, i*25);					}						/*		if(player_target_buf=="g"){					ctx.drawImage(soil_frame_pic, j*25, i*25);					}				if(player_target_buf=="o" || player_target_buf=="O"){					ctx.drawImage(rock_frame_pic, j*25, i*25);					}					if(player_target_buf=="."){					ctx.drawImage(sky_frame_pic, j*25, i*25);					}*/					}				if(player_state=="l"){				ctx.drawImage(player_pic_l, j*25, i*25);				if(player_buf=="o" || player_buf=="O"){					ctx.drawImage(player_rock_l, j*25, i*25);					}									}				if(player_state=="cl_r"){				ctx.drawImage(player_pic_cl_r, j*25, i*25);								}				if(player_state=="cl_l"){				ctx.drawImage(player_pic_cl_l, j*25, i*25);								}						}								}		//document.write("<br>");	}	//next code show frame around target cell	if(player_target_offset_x==2 && player_target_offset_y==2){		player_target_x=player_x+1;		player_target_y=player_y+1;		player_target_buf=map[player_target_y][player_target_x];		}	if(player_target_offset_x==1 && player_target_offset_y==2){		player_target_x=player_x;		player_target_y=player_y+1;		player_target_buf=map[player_target_y][player_target_x];		}	if(player_target_offset_x==0 && player_target_offset_y==2){		player_target_x=player_x-1;		player_target_y=player_y+1;		player_target_buf=map[player_target_y][player_target_x];		}	if(player_target_offset_x==0 && player_target_offset_y==1){		player_target_x=player_x-1;		player_target_y=player_y;		player_target_buf=map[player_target_y][player_target_x];		}	if(player_target_offset_x==0 && player_target_offset_y==0){		player_target_x=player_x-1;		player_target_y=player_y-1;		player_target_buf=map[player_target_y][player_target_x];		}	if(player_target_offset_x==1 && player_target_offset_y==0){		player_target_x=player_x;		player_target_y=player_y-1;		player_target_buf=map[player_target_y][player_target_x];		}	if(player_target_offset_x==2 && player_target_offset_y==0){		player_target_x=player_x+1;		player_target_y=player_y-1;		player_target_buf=map[player_target_y][player_target_x];		}	if(player_target_offset_x==2 && player_target_offset_y==1){		player_target_x=player_x+1;		player_target_y=player_y;		player_target_buf=map[player_target_y][player_target_x];		}			if(player_target_buf=="W"){					player_target_buf=map[player_target_y][player_target_x];					ctx.drawImage(grass_frame_pic, player_target_x*25, player_target_y*25);					}	if(player_target_buf=="g"){					player_target_buf=map[player_target_y][player_target_x];					ctx.drawImage(soil_frame_pic, player_target_x*25, player_target_y*25);					}	if(player_target_buf=="o" || player_target_buf=="O"){					player_target_buf=map[player_target_y][player_target_x];					ctx.drawImage(rock_frame_pic, player_target_x*25, player_target_y*25);					}		if(player_target_buf=="."){					player_target_buf=map[player_target_y][player_target_x];					ctx.drawImage(sky_frame_pic, player_target_x*25, player_target_y*25);										}				}///////////////////////////////////////////////////////////////////////end of show function function add_pig(){for(var i=0;i<10;i++){	if(map[i][2]=="W"){		pig_buf=map[i-1][2];		map[i-1][2]="p";		pig_y=i-1;	}}}function add_cow(){for(var i=0;i<10;i++){	if(map[i][15]=="W"){		cow_buf=map[i-1][15];		map[i-1][15]="c";		cow_y=i-1;	}}}function add_player(){for(var i=0;i<15;i++){	if(map[i][player_x]=="W"){		player_buf = map[i-1][player_x]		map[i-1][player_x]="pl";		player_y=i-1;	}}player_target_x=player_x+1;player_target_y=player_y+1;player_target_buf=map[player_target_y][player_target_x];}function mov_pig(){var act = Math.floor((Math.random()*5)+1);if(act==1){pig_dir="r";if(map[pig_y+1][pig_x+1]=="W" || map[pig_y+1][pig_x+1]=="t"){	//map[pig_y][pig_x]=pig_buf;	//pig_buf=map[pig_y][pig_x+1];	map[pig_y][pig_x]=".";	map[pig_y][pig_x+1]="p";	pig_x=pig_x+1;	return;	}if(map[pig_y+2][pig_x+1]=="W" || map[pig_y+1][pig_x+1]=="t"){	//map[pig_y][pig_x]=pig_buf;	//pig_buf=map[pig_y+1][pig_x+1];	map[pig_y][pig_x]=".";	map[pig_y+1][pig_x+1]="p";	pig_x=pig_x+1;	pig_y=pig_y+1;	return;	}if(map[pig_y][pig_x+1]=="W" || map[pig_y][pig_x+1]=="t"){	//map[pig_y][pig_x]=pig_buf;	//pig_buf=map[pig_y-1][pig_x+1];	map[pig_y][pig_x]=".";	map[pig_y-1][pig_x+1]="p";	pig_x=pig_x+1;	pig_y=pig_y-1;	return;	}if(map[pig_y][pig_x+1]=="pl" && map[pig_y][pig_x-1]=="."){	//map[pig_y][pig_x]=pig_buf;	//pig_buf=map[pig_y][pig_x-1];	map[pig_y][pig_x]=".";	map[pig_y][pig_x-1]="p";	pig_x=pig_x-1;		return;	}		}if(act==2){pig_dir="l";if(map[pig_y+1][pig_x-1]=="W" || map[pig_y+1][pig_x-1]=="t"){	//map[pig_y][pig_x]=pig_buf;	//pig_buf=map[pig_y][pig_x-1];	map[pig_y][pig_x]=".";	map[pig_y][pig_x-1]="p";	pig_x=pig_x-1;	return;	}if(map[pig_y+2][pig_x-1]=="W" || map[pig_y+1][pig_x-1]=="t"){	//map[pig_y][pig_x]=pig_buf;	//pig_buf=map[pig_y+1][pig_x-1];	map[pig_y][pig_x]=".";	map[pig_y+1][pig_x-1]="p";	pig_x=pig_x-1;	pig_y=pig_y+1;	return;	}if(map[pig_y][pig_x-1]=="W" || map[pig_y][pig_x-1]=="t"){	//map[pig_y][pig_x]=pig_buf;	//pig_buf=map[pig_y-1][pig_x-1];	map[pig_y][pig_x]=".";	map[pig_y-1][pig_x-1]="p";	pig_x=pig_x-1;	pig_y=pig_y-1;	return;	}}} //end of mov_pigfunction mov_cow(){var act = Math.floor((Math.random()*8)+1);if(act==1){cow_dir="r";if(map[cow_y+1][cow_x+1]=="W" || map[cow_y+1][cow_x+1]=="t"){	map[cow_y][cow_x]=".";	map[cow_y][cow_x+1]="c";	cow_x=cow_x+1;	return;	}if(map[cow_y+2][cow_x+1]=="W" || map[cow_y+1][cow_x+1]=="t"){	map[cow_y][cow_x]=".";	map[cow_y+1][cow_x+1]="c";	cow_x=cow_x+1;	cow_y=cow_y+1;	return;	}if(map[cow_y][cow_x+1]=="W" || map[cow_y][cow_x+1]=="t"){	map[cow_y][cow_x]=".";	map[cow_y-1][cow_x+1]="c";	cow_x=cow_x+1;	cow_y=cow_y-1;	return;	}	}if(act==2){cow_dir="l";if(map[cow_y+1][cow_x-1]=="W" || map[cow_y+1][cow_x-1]=="t"){	map[cow_y][cow_x]=".";	map[cow_y][cow_x-1]="c";	cow_x=cow_x-1;	return;	}if(map[cow_y+2][cow_x-1]=="W" || map[cow_y+1][cow_x-1]=="t"){	map[cow_y][cow_x]=".";	map[cow_y+1][cow_x-1]="c";	cow_x=cow_x-1;	cow_y=cow_y+1;	return;	}if(map[cow_y][cow_x-1]=="W" || map[cow_y][cow_x-1]=="t"){	map[cow_y][cow_x]=".";	map[cow_y-1][cow_x-1]="c";	cow_x=cow_x-1;	cow_y=cow_y-1;	return;	}}} //end of mov_cowdocument.addEventListener('keydown', function(event) {    //PLAYER CODE		if(event.keyCode == 37) {		if(player_x<=0){			player_x=0;			map[player_y][player_x]="pl";			return;		}		player_state="l";		if(map[player_y][player_x-1]!="g" && map[player_y][player_x-1]!="W" && map[player_y+1][player_x-1]!="."){			map[player_y][player_x]=player_buf;			player_buf=map[player_y][player_x-1];			player_x=player_x-1;			map[player_y][player_x]="pl";			return;        }		if(map[player_y+1][player_x-1]=="."){			map[player_y][player_x]=player_buf;			player_buf=map[player_y+1][player_x-1];			player_x=player_x-1;			player_y=player_y+1; 			map[player_y][player_x]="pl";			return;        }		if(map[player_y-1][player_x-1]=="." && map[player_y-1][player_x]!="W"){						map[player_y][player_x]=player_buf;			player_buf=map[player_y-1][player_x-1];			player_x=player_x-1;			player_y=player_y-1; 			map[player_y][player_x]="pl";			return;	        }		if(map[player_y-1][player_x-1]=="o" && map[player_y-1][player_x]!="g"){	//go step up in the covern					map[player_y][player_x]=player_buf;			player_buf=map[player_y-1][player_x-1];			player_x=player_x-1;			player_y=player_y-1; 			map[player_y][player_x]="pl";			return;	        }		if(map[player_y-1][player_x-1]=="O" && map[player_y-1][player_x]!="g"){	//go step up in the covern					map[player_y][player_x]=player_buf;			player_buf=map[player_y-1][player_x-1];			player_x=player_x-1;			player_y=player_y-1; 			map[player_y][player_x]="pl";			return;	        }		if(map[player_y-1][player_x-1]=="t" && map[player_y-1][player_x]!="W"){						map[player_y][player_x]=player_buf;			player_buf=map[player_y-1][player_x-1];			player_x=player_x-1;			player_y=player_y-1; 			map[player_y][player_x]="pl";			return;	        }		    }    else if(event.keyCode == 39) {		if(player_x>=39){			player_x=39;			map[player_y][player_x]="pl";			return;		}		player_state="r";		if(map[player_y][player_x+1]!="g" && map[player_y][player_x+1]!="W" && map[player_y+1][player_x+1]!="."){			map[player_y][player_x]=player_buf;			player_buf=map[player_y][player_x+1];			player_x=player_x+1;			map[player_y][player_x]="pl";			return;        }		if(map[player_y+1][player_x+1]=="."){			map[player_y][player_x]=player_buf;			player_buf=map[player_y+1][player_x+1];			player_x=player_x+1;			player_y=player_y+1; 			map[player_y][player_x]="pl";			return;        }		if(map[player_y-1][player_x+1]=="." && map[player_y-1][player_x]!="W"){						map[player_y][player_x]=player_buf;			player_buf=map[player_y-1][player_x+1];			player_x=player_x+1;			player_y=player_y-1; 			map[player_y][player_x]="pl";			return;        }		if(map[player_y-1][player_x+1]=="o" && map[player_y-1][player_x]!="g"){						map[player_y][player_x]=player_buf;			player_buf=map[player_y-1][player_x+1];			player_x=player_x+1;			player_y=player_y-1; 			map[player_y][player_x]="pl";			return;        }		if(map[player_y-1][player_x+1]=="O" && map[player_y-1][player_x]!="g"){						map[player_y][player_x]=player_buf;			player_buf=map[player_y-1][player_x+1];			player_x=player_x+1;			player_y=player_y-1; 			map[player_y][player_x]="pl";			return;        }		if(map[player_y-1][player_x+1]=="t" && map[player_y-1][player_x]!="W"){						map[player_y][player_x]=player_buf;			player_buf=map[player_y-1][player_x+1];			player_x=player_x+1;			player_y=player_y-1; 			map[player_y][player_x]="pl";			return;        }    }	else if(event.keyCode == 38){//climb up		if(map[player_y-1][player_x+1]=="W" || map[player_y-1][player_x+1]=="g")		{			if(map[player_y-1][player_x]!="g" && map[player_y-1][player_x]!="W"){			map[player_y][player_x]=player_buf;			player_buf=map[player_y-1][player_x];			//player_x=player_x;			player_y=player_y-1; 			map[player_y][player_x]="pl";			player_state="cl_r";			return;			}		}		if(map[player_y-1][player_x-1]=="W" || map[player_y-1][player_x-1]=="g")		{			if(map[player_y-1][player_x]!="g" && map[player_y-1][player_x]!="W"){			map[player_y][player_x]=player_buf;			player_buf=map[player_y-1][player_x];			//player_x=player_x;			player_y=player_y-1; 			map[player_y][player_x]="pl";			player_state="cl_l";			return;			}		}	}//end of climp up	else if(event.keyCode == 40){//climb down		if(map[player_y+1][player_x]=="o" || map[player_y+1][player_x]=="." || map[player_y+1][player_x]=="t"){			map[player_y][player_x]=player_buf;			player_buf=map[player_y+1][player_x];			//player_x=player_x;			player_y=player_y+1; 			map[player_y][player_x]="pl";			//player_state="cl_l";			return;		}	}	else if(event.keyCode==32){//spacebar - dig or build		if(map[player_target_y][player_target_x]=="W"){			map[player_target_y][player_target_x]="o";			grass_n++;			return;		}		if(map[player_target_y][player_target_x]=="g"){			map[player_target_y][player_target_x]="o";			soil_n++;			return;		}		if(map[player_target_y][player_target_x]=="o" || map[player_target_y][player_target_x]=="O"){			map[player_target_y][player_target_x]=".";			rock_n++;			return;		}		if(map[player_target_y][player_target_x]=="."){///////////////////////////////build						if(it_selected==0 && grass_n>0){				grass_n--;				map[player_target_y][player_target_x]="W"			}			if(it_selected==1 && rock_n>0){				rock_n--;				map[player_target_y][player_target_x]="o"			}			if(it_selected==2 && soil_n>0){				soil_n--;				map[player_target_y][player_target_x]="g"			}				}	}	else if(event.keyCode==68){		//change player_target_offset		player_target_offset_x++;		if(player_target_offset_x==3){			player_target_offset_x=0;		}		if(player_target_offset_x==1 && player_target_offset_y==1){						player_target_offset_x++;		}	}	else if(event.keyCode==65){		//change player_target_offset				player_target_offset_x--;		if(player_target_offset_x==-1){			player_target_offset_x=2;		}		if(player_target_offset_x==1 && player_target_offset_y==1){						player_target_offset_x--;		}	}	else if(event.keyCode==83){		//change player_target_offset		player_target_offset_y++;		if(player_target_offset_y==3){			player_target_offset_y=0;		}		if(player_target_offset_x==1 && player_target_offset_y==1){						player_target_offset_y++;		}	}	else if(event.keyCode==87){		//change player_target_offset				player_target_offset_y--;		if(player_target_offset_y==-1){			player_target_offset_y=2;		}		if(player_target_offset_x==1 && player_target_offset_y==1){						player_target_offset_y--;		}	}	else if(event.keyCode==69){//select item in the bag		it_selected++;		if(it_selected>=3){it_selected=0;};	}});var GameLoop = function(){if(map[player_y+1][player_x]=="." && map[player_y][player_x+1]=="." && map[player_y][player_x-1]=="."){map[player_y][player_x]="."player_y++;map[player_y][player_x]="pl"}if(map[player_y+1][player_x]=="o" && map[player_y][player_x+1]=="o" && map[player_y][player_x-1]=="o"){map[player_y][player_x]="o"player_y++;map[player_y][player_x]="pl"}//document.getElementById("var").innerHTML=player_y;show_map();mov_pig();mov_cow();gLoop = setTimeout(GameLoop, 300);}add_player();add_pig();add_cow();GameLoop();</script></body></html>